<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

	<!-- Font Awesome JS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
    <title>Settings</title>
	<style type="text/css">
	body
	{
		background-image: url("https://images.pexels.com/photos/4464918/pexels-photo-4464918.jpeg?auto=compress&cs=tinysrgb&dpr=1&w=1500")
	}
	.button
{
  background-color:#180754;
  color:white;
  border:none;
  font-size:20px;
  border-radius: 10px;
}
			#navcolor
	 {
		background-color:#180754;
	}


.nav1 {
  display: flex;
  font-size: 13px;
  list-style: none;
  width:100%;
}
.nav1 li:first-child {
  margin-right: auto;
}

.nav1 li a {
  display: block;
  color: #ffffff;
  font-size:25px;
  text-decoration: none;
  
}


#textt
{
	margin-top:20px;
	font-size: 17px;
	color:#180754;
	font-weight:700;
}

.inpt
{
	border:3px solid #180754;
	border-radius: 10px;
}
.add{
    width:70%;
    color: #333333;
	text-align:center;
    margin: 0 auto;
    overflow: hidden;
    align-items: center;
    justify-content: space-around;
    display: flex;
    float: none;
}
.add1{
    width:50%;
    color: #333333;
    margin: 0 auto;
    overflow: hidden;
    align-items: center;
    justify-content: space-around;
    display: flex;
    float: none;
}


@media (max-width: 768px)
{
	.add1{
    width:100%;
    
	}
}


			
	
	
	</style>
  </head>
  <body>
		
		<nav class="navbar fixed-top navbar-expand-lg" id="navcolor">

               <ul class="nav1">
					<li><a style="font-weight: bold" href="#">Settings</a></li>
					<li style="margin-right: 30px;color:white;font-size: 20px;font-weight: bold;"><a href="#"><p id="logout">Log Out</p></a></li>
					<li><a style="font-weight: bold" href="/users/taskpage">Close</a></li>
					
				</ul>                 
                
		</nav>
		
		<div  class="container">
					<div style="margin-top:140px;" class="row add">
					  <div class="col">
						<p id="heading"><span style="font-weight:bold" id="head">Personal Information</span></p>
					  </div>
					</div>
                    <div style="margin-top:50px;" class="row add1">
                        
					  <div class="col-sm-10 form-group-lg">
						<form action="/users/me/avatar" method="POST" enctype="multipart/form-data">
							<div class="form-group">
							<p><span style="font-weight:bold">Photo</span> <span style="margin-left:55px;"><input style="color:white;font-weight:bold" type="file" class="form-control-file" name="avatar"></span></p>
							</div>
                            <button type="submit" class="button">Submit</button>
                        </form>
					  </div>
					</div>
					<div style="margin-top:16px"class="row add1">
					  <div class="col-sm-10 form-group-lg">
							<p><span style="font-weight:bold">Name</span><span style="font-weight: bold;margin-left:57px"><%=user.name%></span></p>
					  </div>
					</div>
					<div class="row add1">
					  <div class="col-sm-10 form-group-lg">
							<p><span style="font-weight:bold">Age</span><span style="font-weight: bold;margin-left:70px"><%=user.age%></span></p>
					  </div>
					</div>
					<div class="row add1">
					  <div class="col-sm-10 form-group-lg">
							<p><span style="font-weight:bold">Email</span><span style="font-weight: bold;margin-left:60px"><%=user.email%></span> <span id="email" style="float:right"><a href="#email">Edit</a></span></p>
					  </div>
					</div>
					
					<div class="row add1">
					  <div class="col-sm-10 form-group-lg">
							<p><span style="font-weight:bold">Password<span><span style="margin-left:30px"><button id="password" class="button">Change Password</button></span></p>
					  </div>
					</div>
		</div>
		<% if(message.length > 0 ){%>
            <div style="margin-top:50px;text-align: center;" class="alert alert-success">
              
              <%=message%>
              <button type="button" name="close" data-dismiss="alert">&times;</button>
            </div>

         <% }%>
		<!-- Modal -->
<div class="modal fade" id="modal3" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalCenterTitle1">Update your Name</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
		<div class="row justify-content-center">
              <p>Enter New Name</p>	
		</div>
		<div class="row justify-content-center">
			<input type="text"></input>
		</div>
		
		
	  </div>
	  <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button onclick="change()"type="button" class="btn btn-primary">Understood</button>
      </div>
      
    </div>
  </div>
</div>


<div class="modal fade" id="modal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalCenterTitle1">Update your email address</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
		<form action="/emailupdate" method="POST">
		<div class="row justify-content-center">
              <p id="textt">New Email</p>	
		</div>
		<div class="row justify-content-center">
			<input class="inpt" type="email" name="oldemail" id="oldemail"></input>
		</div>
		<div class="row justify-content-center">
			<p id="textt">Confirm Email</p>
		</div>
		<div class="row justify-content-center">
			<input class="inpt" type="email" name="newemail" id="newemail" onkeyup="checkemailMatch()"></input>
		</div>
		<div style="text-align: center;" id="showemail">

		</div>
		<div class="row justify-content-center">
			<p id="textt">Password</p>
		</div>
		<div class="row justify-content-center">
			<input class="inpt" type="password" name="password"></input>
		</div>
		
		<button type="submit" style="float:right" class="button">Update</button>
		</form>
	  </div>
	  
        

      
    </div>
  </div>
</div>

<div class="modal fade" id="modal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalCenterTitle1">Update your password</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="/passwordupdate" method="POST">
		<div class="row justify-content-center">
              <p id="textt">New Password</p>	
		</div>
		<div class="row justify-content-center">
			<input class="inpt" type="password" name="newpass"id="old"></input>
		</div>
		<div class="row justify-content-center">
			<p id="textt">Confirm Password</p>
		</div>
		
		<div class="row justify-content-center">
			<input class="inpt" type="password" id="confirm" onkeyup="checkPasswordMatch()"></input>
		</div>
		<div style="text-align: center;" id="show">

		</div>
		<div class="row justify-content-center">
			<p id="textt">Enter Old Password</p>
		</div>
		<div class="row justify-content-center">
			<input class="inpt" type="password" name="oldpass" id="oldpass"></input>
		</div>
		<!-- <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> -->
		<button type="submit"style="float:right" class="button">Update</button>
		</form>
	  </div>
	  
		
      
      
    </div>
  </div>
</div>
    

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
	<script type="text/javascript">
		
		$("#email").click(function()
		{
			$("#modal1").modal('show'); 
		}
		);
		
		$("#password").click(function()
		{
			$("#modal2").modal('show'); 
		}
		);
		
		$("#name").click(function()
		{
			$("#modal3").modal('show'); 
		}
		);
		
		$("#imagecontainer4").click(function()
		{
			$("#modal4").modal('show'); 
		}
		);
		
		function checkPasswordMatch() {
			var password = $("#old").val();
			var confirmPassword = $("#confirm").val();

			if (password != confirmPassword)
			$("#show").html("Passwords do not match!");
			else
			$("#show").html("Passwords match!");
		}
		function checkemailMatch() {
			var email = $("#oldemail").val();
			var confirmemail = $("#newemail").val();

			if (email != confirmemail)
			$("#showemail").html("Emails do not match!");
			else
			$("#showemail").html("Emails match!");
		}
		document.querySelector('#logout').addEventListener('click', (e) => {
    		e.preventDefault();
				
				fetch('/users/logout', {
					method:"post",
					headers:{
						"Content-Type":"application/json",
						
					},
				}).then(data => 
					{
						if(data){ 
						redirect: window.location.replace("/login") 
						console.log('yes')
						} else{
							alert("Invalid Email or Password");
						}
					})

					.catch(error => console.log('error is', error));
		})
	</script>
  </body>
</html>